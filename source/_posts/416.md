---
title: 【25G硬路由】MikroTik CCR2004-1G-2XS-PCIe 
date: 2022-02-20 13:19:04
updated: 2022-02-20 13:19:04
categories: 网络
tags:
- 宽带
- 网卡
- ROS
- 路由器
- MikroTik
- 万兆
- 千兆
- 企业级
- 交换机
- DIY
---
MikroTik官方推出了一款很奇特的产品CCR2004-1G-2XS-PCIe ，看着像一张显卡，其实是一张25G SFP28的网卡，还是一款PCIe的路由器，把路由器藏在一张PCIe卡上。对于这样的独特应用，我的理解也是模糊的。
<!-- more -->
![](https://lfs.libmbr.com/assets/2022/02/20/cc.jpg)
官方介绍：把CCR2004做成PCIe卡安装到服务器，是为了节省机柜的空间。而对于这样的设计，在服务器上使用结合了一张2x 25G PCIe以太网适配器和一个功能齐全的路由器，会让人印象非常深刻。

<iframe width="720" height="405" frameborder="0" src="https://www.ixigua.com/iframe/7066630550010331684?autoplay=0" referrerpolicy="unsafe-url" allowfullscreen></iframe>

默认情况下，PCIe网卡将显示为四个虚拟以太网接口：25G SFP28作为两个直通模式接口显示，另外两个虚拟的以太网PCIe接口和一个千兆以太网桥接，用于管理访问。用户可以自由配置所有的接口和设置，因为内置了完整的RouterOS功能。

![](https://lfs.libmbr.com/assets/2022/02/20/ph.jpg)

CCR2004-1G-2XS-PCIe也可以作为一个网卡工作，即直通模式。基本上，FastForward与FastPath模式也可以传递硬件链路状态。并且网卡可以使用巨帧线速转发(总线100Gbps)，能确保在大多数服务器设置中，CCR网卡不会成为传输瓶颈。在独立路由器模式下，能处理的网络应用包括:防火墙、用户管理、家庭媒体和文件服务器的访问控制，甚至一些数据中心的流量控制等，而不需要再安装一台独立的路由器。

处理器仍然采用， AL32400 4核心, ARMv8处理器，4G内存，128M NAND存储，从资料看CPU频率是2G，之前的CCR2004两款频率都是1.7G，理论上塞进服务器的空间狭小，应该降低功耗才对，但这款居然把频率提上去了，让真正的CCR2004路由器感觉凉凉的，估计MikroTik认为服务器里面的散热更凉快。

当然CCR2004-1G-2XS-PCIe在启动时存在一些局限，CCR2004-1G-2XS-PCIe需要一点启动时间。如果主机操作系统在CCR卡之前启动，将不会出现在可用的设备中。应该在BIOS中增加PCIe设备上电后的初始化延迟，或者在主机系统里重新初始化PCIe设备。安装MikroTik提供的信息，支持的服务器系统为Linux或者FreeBSD。

如下是官方给出在Linux上设置重新初始化，*设备id为：0000\:03\:00.0*

```
echo "1" > /sys/bus/pci/devices/0000\:03\:00.0/remove
sleep 2
echo "1" > /sys/bus/pci/rescan
```

官方很期待这个非传统设备的独特使用案例:一个高速网卡结合一个强大路由器，利用RouterOS强大的功能释放服务器的潜力!

| 产品代码      | CCR2004-1G-2XS-PCIe |
| --------------- | --------------------- |
| CPU           |  AL32400 2 GHz      |
| CPU 构架       | ARM 64bit           |
| CPU 核心       | 4                   |
| RAM           | 4GB                 |
| RAM 类型       | DDR4                |
| ROM           | 128 MB, NAND        |
| 1G 以太网电口  | 1                   |
| 25G SFP28     | 2                   |
| RouterOS 许可 |  level 6            |
| 尺寸          | 170 x 69 x 18 mm    |
| 工作温度      |  -20°C to +60°C   |
| 最大功率      | 25W                 |

售价199USD，大概1200RMB，估计没有内置的交换芯片，硬件设计框架图还需要等官方公布资料在看看.对于IDC来说，一个机柜的空间是有限的，作为采购方租用一个机柜成本固定的情况下，希望放置更多的设备，如果把路由器塞进一台服务器的PCIe中，好像也就节约了1U的空间。但如果你只租用2U-4U的空间，安装1-3台服务器，可能这个PCIe路由器到也能为你节约可观的机柜成本。

如果真的安装到了PC主机或者服务器里，当服务器重启，PCIe网卡没有正常启动会如何？使用中出现驱动问题，导致网络中断，又会怎么？各种问题场景都可能出现，也可能在IDC上架时，搬运过程中PCIe接口松动，又会导致现场人员拆机处理。作为商业运营的数据中心，稳定压倒一切，多使用一个U位安装路由器更安心，不至于抠一个U位的成本。当然你有DIY的精神另当别论，DIY的目就是在有限的资源下，效益最大化！写着写着感觉MikroTik的产品一直都是这个DIY的定位。

当然我没有体验过CCR2004-1G-2XS-PCIe产品，也不能过多评价，现在认知仅供参考，以后有机会体验后评价。

From http://www.irouteros.com/?p=2562
